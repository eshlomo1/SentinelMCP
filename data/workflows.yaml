workflows:
  workflow_1:
    name: "Standard Alert to Resolution"
    description: "Complete workflow from alert to resolution"
    steps:
    - step_1:
        name: "Alert Received"
        performer: "External System"
        action: "Send alert to Sentinel MCP"
        output: "raw_alert"
        time_estimate: "1 minute"

    - step_2:
        name: "Alert Normalization"
        performer: "Tier1-AlertParser"
        action: "Parse and normalize alert format"
        output: "normalized_alert"
        time_estimate: "2-5 minutes"
        sla_compliance_required: true

    - step_3:
        name: "Alert Enrichment"
        performer: "Tier1-AlertEnricher"
        action: "Enrich with threat intel and context"
        output: "enriched_alert"
        time_estimate: "3-10 minutes"
        sla_compliance_required: true

    - step_4:
        name: "False Positive Check"
        performer: "Tier1-FalsePositiveEliminator"
        action: "Check against FP patterns"
        decision_point: true
        paths:
        - condition: "False Positive Detected"
          next_step: "Mark as FP and Archive"
        - condition: "True Positive"
          next_step: "step_5"
        time_estimate: "1-3 minutes"

    - step_5:
        name: "Alert Routing"
        performer: "Tier1-AlertRouter"
        action: "Route to appropriate destination"
        decision_point: true
        paths:
        - condition: "Severity=Critical or Compromise Evidence"
          next_step: "Escalate to Tier2"
        - condition: "Severity=High"
          next_step: "Escalate to Tier2"
        - condition: "Severity=Medium"
          next_step: "Tier1 Investigation Queue"
        - condition: "Severity=Low"
          next_step: "Batch Review Queue"
        time_estimate: "1-2 minutes"
        sla_compliance_required: true

    - step_6:
        name: "Tier 1 Investigation"
        performer: "Tier1-AlertRouter (with team)"
        condition: "If routed to Tier 1 Investigation Queue"
        action: "Preliminary investigation and fact gathering"
        output: "preliminary_findings"
        time_estimate: "30-120 minutes"
        decision_point: true
        paths:
        - condition: "Resolves as FP or resolved"
          next_step: "Close"
        - condition: "Requires deeper investigation"
          next_step: "Escalate to Tier2"

    - step_7:
        name: "Tier 2 Investigation"
        performer: "Tier2 Agents (parallel)"
        condition: "If escalated to Tier2"
        action: "In-depth analysis by malware, network, identity, threat assessment"
        sub_steps:
        - "Tier2-MalwareAnalyzer analyzes files/processes"
        - "Tier2-NetworkInvestigator analyzes network activity"
        - "Tier2-IdentityAnalyzer checks for identity risks"
        - "Tier2-ThreatAssessor consolidates findings"
        output: "investigation_report"
        time_estimate: "4-24 hours"
        decision_point: true
        paths:
        - condition: "Resolves as FP"
          next_step: "Close Investigation"
        - condition: "Confirmed Incident"
          next_step: "Escalate to Tier3"
        - condition: "Ongoing Monitoring Required"
          next_step: "Create Case and Monitor"

    - step_8:
        name: "Tier 3 Forensic Analysis"
        performer: "Tier3 Agents (sequential)"
        condition: "If escalated to Tier3"
        action: "Deep forensic investigation"
        sub_steps:
        - "Tier3-EvidenceCollector preserves evidence"
        - "Tier3-ForensicInvestigator performs analysis"
        - "Tier3-IncidentReconstructor builds timeline"
        - "Tier3-RootCauseAnalyzer determines root cause"
        output: "forensic_report, case_documentation"
        time_estimate: "24-72 hours"

    - step_9:
        name: "Remediation"
        performer: "IT/Security Operations"
        action: "Implementation of recommended actions"
        input: "remediation_recommendations"
        time_estimate: "Variable based on actions"

    - step_10:
        name: "Closure"
        performer: "Investigation Lead"
        action: "Review findings and close case"
        output: "closed_investigation, lessons_learned"
        time_estimate: "1-2 hours"

    sla_targets:
    - "Tier 1 response: Within 1 hour"
    - "Tier 2 response: Within 4 hours"
    - "Tier 3 response: Within 24 hours"

  workflow_2:
    name: "Cloud Infrastructure Discovery to Remediation"
    description: "Cloud threat hunting workflow"
    steps:
    - step_1:
        name: "Cloud Data Collection"
        performer: "Cloud Systems"
        action: "Collect logs and configuration data"
        frequency: "Continuous"

    - step_2:
        name: "Infrastructure Analysis"
        performer: "CloudHunter-InfrastructureAnalyzer"
        action: "Scan for misconfigurations"
        time_estimate: "2 hours"

    - step_3:
        name: "Log Anomaly Detection"
        performer: "CloudHunter-LogAnomalyDetector"
        action: "Detect anomalous patterns"
        time_estimate: "1-2 hours"

    - step_4:
        name: "Threat Intelligence Enrichment"
        performer: "CloudHunter-ThreatIntelligenceEnricher"
        action: "Correlate with threat intel"
        time_estimate: "1 hour"

    - step_5:
        name: "Proactive Hunting"
        performer: "CloudHunter-ProactiveHunter"
        action: "Search for advanced threats"
        time_estimate: "4 hours"

    - step_6:
        name: "Finding Aggregation"
        performer: "CloudHunter Coordinator"
        action: "Aggregate findings"
        decision_point: true
        paths:
        - condition: "High Risk Finding"
          next_step: "Escalate to Tier2"
        - condition: "Low Risk Finding"
          next_step: "Log Finding"

    - step_7:
        name: "Report Generation"
        performer: "CloudHunter System"
        action: "Generate hunting report"
        frequency: "Daily/Weekly"

    cycle_frequency: "Daily"
    continuous_operations: true

escalation_workflows:
  escalation_1:
    name: "Alert to Investigation Escalation"
    trigger: "severity=high OR severity=critical OR evidence_of_compromise=true"
    source_tier: "tier1"
    target_tier: "tier2"
    escalation_time: "Immediate"
    escalation_reason: "Alert meets escalation criteria"

  escalation_2:
    name: "Investigation to Forensics Escalation"
    trigger: "confirmed_incident=true AND requires_forensics=true"
    source_tier: "tier2"
    target_tier: "tier3"
    escalation_time: "Within 2 hours"
    escalation_reason: "Confirmed incident requires forensic analysis"

  escalation_3:
    name: "Cloud Finding to Tier2 Escalation"
    trigger: "finding_severity=high OR finding_severity=critical"
    source: "cloud_hunter"
    target_tier: "tier2"
    escalation_time: "Within 1 hour"
    escalation_reason: "Significant cloud threat identified"

  escalation_4:
    name: "Case to Legal Escalation"
    trigger: "case_type=confirmed_breach AND legal_implications=true"
    source_tier: "tier3"
    target: "Legal/Compliance"
    escalation_time: "Within 4 hours"
    escalation_reason: "Legal notification required"

sla_definitions:
  sla_tier1:
    critical:
      initial_response: "15 minutes"
      escalation_to_tier2: "30 minutes"
    high:
      initial_response: "1 hour"
      escalation_to_tier2: "2 hours"
    medium:
      initial_response: "2 hours"
      escalation_to_tier2: "4 hours"
    low:
      initial_response: "4 hours"
      escalation_to_tier2: "24 hours"

  sla_tier2:
    critical:
      investigation_start: "1 hour"
      preliminary_findings: "4 hours"
      escalation_to_tier3: "8 hours"
    high:
      investigation_start: "4 hours"
      preliminary_findings: "24 hours"
      escalation_to_tier3: "24 hours"
    medium:
      investigation_start: "8 hours"
      preliminary_findings: "48 hours"
      escalation_to_tier3: "72 hours"

  sla_tier3:
    critical:
      forensic_start: "8 hours"
      initial_report: "48 hours"
      final_report: "72 hours"
    high:
      forensic_start: "24 hours"
      initial_report: "72 hours"
      final_report: "120 hours"
